(this["webpackJsonprealtime-editor"]=this["webpackJsonprealtime-editor"]||[]).push([[0],{22:function(e,t){e.exports={JOIN:"join",JOINED:"joined",DISCONNECTED:"disconnected",CODE_CHANGE:"code-change",SYNC_CODE:"sync-code",LEAVE:"leave"}},55:function(e,t,n){},56:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(44),a=n.n(r),o=(n(55),n(56),n(31)),s=n(2),i=n(5),u=n(84),l=n(20),j=n.n(l),d=n(4);var O=function(){var e=Object(s.p)(),t=Object(c.useState)(""),n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(""),l=Object(i.a)(o,2),O=l[0],b=l[1],f=function(){r&&O?e("/editor/".concat(r),{state:{username:O}}):j.a.error("Room ID and username is required")},m=function(e){"Enter"===e.code&&f()};return Object(d.jsxs)("div",{className:"homePageWrapper",children:[Object(d.jsxs)("div",{className:"formWrapper",children:[Object(d.jsx)("img",{className:"homePageLogo",src:"/code-sync.png",alt:"code-sync"}),Object(d.jsx)("h4",{className:"mainLabel",children:"Paste Invitaion ROOM ID"}),Object(d.jsxs)("div",{className:"inputGroup",children:[Object(d.jsx)("input",{type:"text",className:"inputBox",placeholder:"ROOM ID",onChange:function(e){return a(e.target.value)},value:r,onKeyUp:m}),Object(d.jsx)("input",{type:"text",className:"inputBox",placeholder:"USERNAME",onChange:function(e){return b(e.target.value)},value:O,onKeyUp:m}),Object(d.jsx)("button",{className:"btn joinBtn",onClick:f,children:"Join"}),Object(d.jsxs)("span",{className:"createInfo",children:["If you don't have invite then create \xa0",Object(d.jsx)("a",{onClick:function(e){e.preventDefault();var t=Object(u.a)();a(t),j.a.success("Created a new room")},href:"",className:"createNewBtn",children:"new room"})]})]})]}),Object(d.jsx)("footer",{children:Object(d.jsx)("h4",{children:"Built by arvind"})})]})},b=n(3),f=n(8);var m=function(e){var t=e.username;return Object(d.jsx)("div",{className:"client",children:Object(d.jsx)("span",{className:"userName",children:t})})},p=n(28),h=n.n(p),v=(n(72),n(73),n(74),n(75),n(77),n(22)),x=n.n(v),N=function(e){var t=e.socketRef,n=e.roomId,r=e.onCodeChange,a=Object(c.useRef)(null);return Object(c.useEffect)((function(){function e(){return(e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.current=h.a.fromTextArea(document.getElementById("realtimeEditor"),{mode:{name:"javascript",json:!0},theme:"dracula",autoCloseTags:!0,autoCloseBrackets:!0,lineNumbers:!0}),a.current.on("change",(function(e,c){var a=c.origin,o=e.getValue();r(o),"setValue"!==a&&t.current.emit(x.a.CODE_CHANGE,{roomId:n,code:o})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){return t.current&&t.current.on(x.a.CODE_CHANGE,(function(e){var t=e.code;null!==t&&a.current.setValue(t)})),function(){t.current.off(x.a.CODE_CHANGE)}}),[t.current]),Object(d.jsx)("textarea",{id:"realtimeEditor"})},C=n(46),g=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={"force new connection":!0,reconnectionAttempt:"Infinity",timeout:1e4,transports:["websocket"]},e.abrupt("return",Object(C.a)("http://localhost:5000",t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var I=function(){var e=Object(c.useRef)(null),t=Object(c.useRef)(null),n=Object(s.n)(),r=Object(s.r)().roomId,a=Object(s.p)(),o=Object(c.useState)([]),u=Object(i.a)(o,2),l=u[0],O=u[1];function p(){return(p=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(r);case 3:j.a.success("Room Id has been copied to your clipboard"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),j.a.error("Could not copy the room id");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}return Object(c.useEffect)((function(){var c=function(){var c=Object(f.a)(Object(b.a)().mark((function c(){var o,s;return Object(b.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return s=function(e){console.log("socket error",e),j.a.error("Socket Connection failed, try again later"),a("/")},c.next=3,g();case 3:e.current=c.sent,e.current.on("connect_error",(function(e){return s(e)})),e.current.on("connect_failed",(function(e){return s(e)})),e.current.emit(x.a.JOIN,{roomId:r,username:null===(o=n.state)||void 0===o?void 0:o.username}),e.current.on(x.a.JOINED,(function(c){var r,a=c.clients,o=c.username,s=c.socketId;o!==(null===(r=n.state)||void 0===r?void 0:r.username)&&j.a.success("".concat(o," joined this room.")),O(a),e.current.emit(x.a.SYNC_CODE,{code:t.current,socketId:s})})),e.current.on(x.a.DISCONNECTED,(function(e){var t=e.socketId,n=e.username;j.a.success("".concat(n," left the room.")),O((function(e){return e.filter((function(e){return e.socketId!==t}))}))}));case 9:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return c(),function(){e.current.disconnect(),e.current.off(x.a.JOINED),e.current.off(x.a.DISCONNECTED)}}),[]),n.state?Object(d.jsxs)("div",{className:"mainWrap",children:[Object(d.jsxs)("div",{className:"aside",children:[Object(d.jsxs)("div",{className:"asideInner",children:[Object(d.jsx)("div",{className:"logo",children:Object(d.jsx)("img",{className:"logoImage",src:"/code-sync.png",alt:"logo"})}),Object(d.jsx)("h3",{children:"Connected"}),Object(d.jsx)("div",{className:"clientsList",children:l.map((function(e){return Object(d.jsx)(m,{username:e.username},e.socketId)}))})]}),Object(d.jsx)("button",{className:"btn copyBtn",onClick:function(){return p.apply(this,arguments)},children:"Copy ROOM ID"}),Object(d.jsx)("button",{className:"btn leaveBtn",onClick:function(){a("/")},children:"Leave"})]}),Object(d.jsx)("div",{className:"editorWrap",children:Object(d.jsx)(N,{socketRef:e,roomId:r,onCodeChange:function(e){t.current=e}})})]}):Object(d.jsx)(s.a,{to:"/"})};var E=function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{children:Object(d.jsx)(l.Toaster,{position:"top-right",toastOptions:{success:{theme:{primary:"#4aed88"}}}})}),Object(d.jsx)(o.a,{children:Object(d.jsxs)(s.d,{children:[Object(d.jsx)(s.b,{path:"/",element:Object(d.jsx)(O,{})}),Object(d.jsx)(s.b,{path:"/editor/:roomId",element:Object(d.jsx)(I,{})})]})})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))};a.a.createRoot(document.getElementById("root")).render(Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(E,{})})),y()}},[[82,1,2]]]);
//# sourceMappingURL=main.d020fc1a.chunk.js.map